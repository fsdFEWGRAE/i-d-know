<!DOCTYPE html>
<html>
<head>
<title>Create - GLOM Authorization</title>
<link rel="stylesheet" href="/glom.css">
</head>
<body class="dash-bg">
<div id="mouse-glow"></div>
<script src="/glom.js"></script>
<div class="sidebar">
  <h3>GLOM</h3>
  <ul>
    <li onclick="location.href='/dashboard'">Dashboard</li>
    <li onclick="location.href='/create'">Create</li>
    <li onclick="location.href='/keys'">Keys</li>
    <li onclick="location.href='/products'">Products</li>
    <li onclick="location.href='/sources'">Sources</li>
    <li onclick="location.href='/panels'">Panels</li>
    <li onclick="location.href='/api'">API</li>
    <li onclick="location.href='/logs'">Logs</li>
    <li onclick="location.href='/settings'">Settings</li>
  </ul>
</div>
<div class="dashboard-area">
<h2>Create Keys / Panels / Sources</h2>
<div class="glass-card" style="max-width:480px;">
  <label>Type:</label>
  <select class="glass-input" id="type">
    <option value="key">Key</option>
  </select>
  <label>Product:</label>
  <select class="glass-input" id="product"></select>
  <label>Duration:</label>
  <select class="glass-input" id="duration">
    <option value="1h">1 Hour</option>
    <option value="1d">1 Day</option>
    <option value="7d">7 Days</option>
    <option value="30d">30 Days</option>
    <option value="lifetime">Lifetime</option>
  </select>
  <label>Quantity:</label>
  <input class="glass-input" id="qty" value="1">
  <button class="generate-btn" onclick="generate()">Generate</button>
</div>
<div class="glass-card">
  <h3>Result</h3>
  <pre id="result"></pre>
</div>
</div>
<script>
const token = localStorage.getItem("glom_token");
if(!token) location.href="/login";

async function loadProducts(){
  const res = await fetch("/product/list",{ headers:{ "Authorization":"Bearer "+token }});
  const data = await res.json();
  const sel = document.getElementById("product");
  data.forEach(p=> sel.innerHTML += `<option value="${p.name}">${p.name}</option>`);
}

async function generate(){
  const payload = {
    type: document.getElementById("type").value,
    product: document.getElementById("product").value,
    duration: document.getElementById("duration").value,
    quantity: document.getElementById("qty").value
  };
  const res = await fetch("/create/generate",{
    method:"POST",
    headers:{ "Content-Type":"application/json","Authorization":"Bearer "+token },
    body: JSON.stringify(payload)
  });
  const data = await res.json();
  document.getElementById("result").innerText = (data.keys||[]).join("\n");
}
loadProducts();
</script>
</body>
</html>
